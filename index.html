function calculateDepreciation() {
    // ... (โค้ดส่วนอื่นๆ ยังคงเหมือนเดิม)

    // สำหรับวิธีเส้นตรง
    let remainingStraightLine = cowPrice;
    for (let i = 0; i <= productiveYears; i++) {
        let depreciation = i === 0 ? 0 : straightLineDepreciation;
        resultHTML += `<tr><td>${i}</td><td>${depreciation.toLocaleString('th-TH', {maximumFractionDigits: 0})}</td><td>${remainingStraightLine.toLocaleString('th-TH', {maximumFractionDigits: 0})}</td></tr>`;
        remainingStraightLine -= depreciation;
    }
    resultHTML += '</table>';

    // สำหรับวิธีตามปริมาณผลผลิต
    let remainingProductionBased = cowPrice;
    let totalDepreciation = 0;
    for (let i = 0; i <= productiveYears; i++) {
        let productionBasedDepreciation;
        if (i === 0 || i === 1) {
            productionBasedDepreciation = 0; // ไม่มีค่าเสื่อมในท้องที่ 0 และ 1
        } else if (i === productiveYears) {
            productionBasedDepreciation = remainingProductionBased - salvageValue;
        } else {
            productionBasedDepreciation = Math.round((cowPrice - salvageValue) * milkProduction[i-2] / totalMilk);
        }
        resultHTML += `<tr><td>${i}</td><td>${productionBasedDepreciation.toLocaleString('th-TH', {maximumFractionDigits: 0})}</td><td>${remainingProductionBased.toLocaleString('th-TH', {maximumFractionDigits: 0})}</td></tr>`;
        if (i > 1) { // เริ่มหักค่าเสื่อมหลังท้องที่ 1
            remainingProductionBased -= productionBasedDepreciation;
            totalDepreciation += productionBasedDepreciation;
        }
    }
    resultHTML += '</table>';

    resultHTML += '<p class="explanation">หมายเหตุ: ในวิธีตามปริมาณผลผลิต มูลค่าคงเหลือในท้องที่ 0 และ 1 เท่ากับราคาซื้อ เนื่องจากเริ่มคิดค่าเสื่อมเมื่อสิ้นสุดการให้นมในท้องที่ 1</p>';

    document.getElementById('result').innerHTML = resultHTML;
}
